local h=game:GetService("HttpService")local _={}do _.Folder="LinoriaLibSettings"_.Library=nil _.BuiltInThemes={["Default"]={1,h:JSONDecode('{"FontColor":"ffffff","MainColor":"191925","AccentColor":"6759b3","BackgroundColor":"16161f","OutlineColor":"323232"}')}}local function O(p,q)return p[q]end function _:ApplyTheme(t)local c=self:GetCustomTheme(t)local d=c or O(self.BuiltInThemes,t)if not d then return end local s=d[2]for i,o in next,c or s do self.Library[i]=Color3.fromHex(o)if Options[i]then Options[i]:SetValueRGB(Color3.fromHex(o))end end self:ThemeUpdate()end function _:ThemeUpdate()local o={"FontColor","MainColor","AccentColor","BackgroundColor","OutlineColor"}for i,f in next,o do if Options and Options[f]then self.Library[f]=Options[f].Value end end self.Library.AccentColorDark=self.Library:GetDarkerColor(self.Library.AccentColor)self.Library:UpdateColorsUsingRegistry()end function _:LoadDefault()local t="Default"local c=isfile(self.Folder.."/themes/default.txt")and readfile(self.Folder.."/themes/default.txt")local i=true if c then if self.BuiltInThemes[c]then t=c elseif self:GetCustomTheme(c)then t=c i=false end elseif self.BuiltInThemes[self.DefaultTheme]then t=self.DefaultTheme end if i then Options.ThemeManager_ThemeList:SetValue(t)else self:ApplyTheme(t)end end function _:SaveDefault(t)writefile(self.Folder.."/themes/default.txt",t)end function _:CreateThemeManager(g)g:AddLabel("Background color"):AddColorPicker("BackgroundColor",{Default=self.Library.BackgroundColor})g:AddLabel("Main color"):AddColorPicker("MainColor",{Default=self.Library.MainColor})g:AddLabel("Accent color"):AddColorPicker("AccentColor",{Default=self.Library.AccentColor})g:AddLabel("Outline color"):AddColorPicker("OutlineColor",{Default=self.Library.OutlineColor})g:AddLabel("Font color"):AddColorPicker("FontColor",{Default=self.Library.FontColor})local A={}for N,T in next,self.BuiltInThemes do table.insert(A,N)end table.sort(A,function(a,b)return self.BuiltInThemes[a][1]<self.BuiltInThemes[b][1]end)g:AddDivider()g:AddDropdown("ThemeManager_ThemeList",{Text="Theme list",Values=A,Default=1})g:AddButton("Set as default",function()self:SaveDefault(Options.ThemeManager_ThemeList.Value)self.Library:Notify(string.format("Set default theme to %q",Options.ThemeManager_ThemeList.Value))end)Options.ThemeManager_ThemeList:OnChanged(function()self:ApplyTheme(Options.ThemeManager_ThemeList.Value)end)g:AddDivider()g:AddInput("ThemeManager_CustomThemeName",{Text="Custom theme name"})g:AddDropdown("ThemeManager_CustomThemeList",{Text="Custom themes",Values=self:ReloadCustomThemes(),AllowNull=true,Default=1})g:AddDivider()g:AddButton("Save theme",function()self:SaveCustomTheme(Options.ThemeManager_CustomThemeName.Value)Options.ThemeManager_CustomThemeList:SetValues(self:ReloadCustomThemes())Options.ThemeManager_CustomThemeList:SetValue(nil)end):AddButton("Load theme",function()self:ApplyTheme(Options.ThemeManager_CustomThemeList.Value)end)g:AddButton("Refresh list",function()Options.ThemeManager_CustomThemeList:SetValues(self:ReloadCustomThemes())Options.ThemeManager_CustomThemeList:SetValue(nil)end)g:AddButton("Set as default",function()if Options.ThemeManager_CustomThemeList.Value~=nil and Options.ThemeManager_CustomThemeList.Value~="" then self:SaveDefault(Options.ThemeManager_CustomThemeList.Value)self.Library:Notify(string.format("Set default theme to %q",Options.ThemeManager_CustomThemeList.Value))end end)_:LoadDefault()local function U()self:ThemeUpdate()end Options.BackgroundColor:OnChanged(U)Options.MainColor:OnChanged(U)Options.AccentColor:OnChanged(U)Options.OutlineColor:OnChanged(U)Options.FontColor:OnChanged(U)end function _:GetCustomTheme(f)local p=self.Folder.."/themes/"..f if not isfile(p)then return nil end local d=readfile(p)local s,de=pcall(h.JSONDecode,h,d)if not s then return nil end return de end function _:SaveCustomTheme(f)if f:gsub(" ","")==""then return self.Library:Notify("Invalid file name for theme (empty)",3)end local t={}local F={"FontColor","MainColor","AccentColor","BackgroundColor","OutlineColor"}for _,fi in next,F do t[fi]=Options[fi].Value:ToHex()end writefile(self.Folder.."/themes/"..f..".json",h:JSONEncode(t))end function _:ReloadCustomThemes()local l=listfiles(self.Folder.."/themes")local o={}for i=1,#l do local f=l[i]if f:sub(-5)==".json"then local p=f:find(".json",1,true)local c=f:sub(p,p)while c~="/"and c~="\\"and c~=""do p=p-1 c=f:sub(p,p)end if c=="/"or c=="\\"then table.insert(o,f:sub(p+1))end end end return o end function _:SetLibrary(l)self.Library=l end function _:BuildFolderTree()local p={}local P=self.Folder:split("/")for i=1,#P do p[#p+1]=table.concat(P,"/",1,i)end table.insert(p,self.Folder.."/themes")table.insert(p,self.Folder.."/settings")for i=1,#p do local s=p[i]if not isfolder(s)then makefolder(s)end end end function _:SetFolder(f)self.Folder=f self:BuildFolderTree()end function _:CreateGroupBox(t)assert(self.Library,"Must set ThemeManager.Library first!")return t:AddLeftGroupbox("Themes")end function _:ApplyToTab(t)assert(self.Library,"Must set ThemeManager.Library first!")local g=self:CreateGroupBox(t)self:CreateThemeManager(g)end function _:ApplyToGroupbox(g)assert(self.Library,"Must set ThemeManager.Library first!")self:CreateThemeManager(g)end _:BuildFolderTree()end return _
